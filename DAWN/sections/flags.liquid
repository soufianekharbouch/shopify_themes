{{ 'flags.css' | asset_url | stylesheet_tag }}
<div class="CountrysPopup ActivePopup">
  <div class="CountrysOverlap">

  </div>
  <div class="CountrysContainer">
    <div class="CountrysHead">
      <img src="{{ section.settings.image | img_url:'300x' }}"/>
      <h3>{{section.settings.welcome_text}}</h3>
      <p>{{ section.settings.heading1 }}</p>
    </div>
      <div class="FlagsContainer">
        {% for block in section.blocks %}
          <a href="{{ block.settings.url }}">
            {% assign iso=block.settings.iso %}
            {% render 'flags', currency_iso: iso  %}
            <span>
            {{ block.settings.country }}
            </span>
          </a>
        {% endfor %}
      </div>



  </div>
</div>

<script>
  function findGetParameter(parameterName) {
    var result = null,
      tmp = [];
    location.search
      .substr(1)
      .split("&")
      .forEach(function (item) {
        tmp = item.split("=");
        if (tmp[0] === parameterName) result = decodeURIComponent(tmp[1]);
      });
    return result;
  }
  function setCookie(name,value,days) {
    var expires = "";
    if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days*24*60*60*1000));
        expires = "; expires=" + date.toUTCString();
    }
    document.cookie = name + "=" + (value || "")  + expires + "; path=/";
  }
  if(findGetParameter("country")){
    setCookie('country', findGetParameter("country"),30);
  }

  function getCookie(c_name) {
    var c_value = document.cookie,
        c_start = c_value.indexOf(" " + c_name + "=");
    if (c_start == -1) c_start = c_value.indexOf(c_name + "=");
    if (c_start == -1) {
        c_value = null;
    } else {
        c_start = c_value.indexOf("=", c_start) + 1;
        var c_end = c_value.indexOf(";", c_start);
        if (c_end == -1) {
            c_end = c_value.length;
        }
        c_value = unescape(c_value.substring(c_start, c_end));
    }
    return c_value;
}
  if(getCookie('country')){
    $('.CountrysPopup').removeClass("ActivePopup")
  }else{
    $('.CountrysPopup').addClass("ActivePopup")
  }

</script>
{% schema %}
{
  "name": "Countrys",
  "tag": "section",
  "class": "section",
  "settings": [
    {
        "type": "text",
        "id": "welcome_text",
        "label": "Welcome Text",
        "default": "Welcome"
      },
      {
        "type": "html",
        "id": "heading1",
        "label": "Close box text",
        "default": "About Us"
      },
      {
        "type": "textarea",
        "id": "details",
        "label": "Details",
        "default": "We are a company dedicated to providing quality products and excellent service."
      },
      {
        "type": "image_picker",
        "id": "image",
        "label": "Image"
      }
  ],
  "blocks": [
    {
    "type":"country",
    "name":"countrys",
    "settings":[
      
        {
          "type": "text",
          "id": "country",
          "label": "country name"
        },
        {
          "type": "text",
          "id": "iso",
          "label": "ISO CODE"
        },
        {
          "type": "text",
          "id": "url",
          "label": "URL"
        }
      
     ]
    }
  ],
  "presets": [
    {
      "name": "Countrys" 
    }
  ]
}
{% endschema %}
